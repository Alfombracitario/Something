<!DOCTYPE html><html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Juego Terminal RPG</title>
    <style>
        /* VARIABLES PERSONALIZABLES */
        :root {
            --terminal-bg: #000;
            --terminal-text: #0f0;
            --terminal-aspect: 4/3;
            --button-bg: #333;
            --button-active: #555;
            --button-text: #fff;
            --button-size: 64px;
            --button-gap: 8px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; touch-action: manipulation; user-select: none; }
        body {
            background: #111;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            font-family: 'Courier New', monospace;
            padding: 10px;
        }
        #game-container {
            display: flex;
            flex-direction: column;
            height: 100%;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            gap: 15px;
        }
        #terminal {
            background: var(--terminal-bg);
            color: var(--terminal-text);
            font-size: 12px;
            line-height: 1.4;
            padding: 15px;
            border: 2px solid #333;
            border-radius: 8px;
            flex: 1;
            overflow: hidden;
            position: relative;
            aspect-ratio: var(--terminal-aspect);
            min-height: 0;
        }
        #terminal-content {
            white-space: pre-wrap;
            word-break: break-word;
            height: 100%;
            overflow: auto;
            display: block;
        }
        #controls {
            padding: 5px 0 15px;
        }
        .button-row {
            display: flex;
            justify-content: center;
            gap: var(--button-gap);
            margin-bottom: var(--button-gap);
        }
        .button-cell {
            flex: 1;
            display: flex;
            justify-content: center;
            max-width: calc(var(--button-size) * 1.5);
        }
        .btn {
            width: var(--button-size);
            height: var(--button-size);
            border-radius: 50%;
            background: var(--button-bg);
            color: var(--button-text);
            border: 2px solid #000;
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.1s;
            box-shadow: 0 4px 0 rgba(0,0,0,0.3);
        }
        .btn:active {
            background: var(--button-active);
            transform: translateY(4px);
            box-shadow: 0 1px 0 rgba(0,0,0,0.3);
        }
        #btn-up::after    { content: "↑"; }
        #btn-down::after  { content: "↓"; }
        #btn-left::after  { content: "←"; }
        #btn-right::after { content: "→"; }
        #btn-a::after     { content: "A"; }
        #btn-b::after     { content: "B"; }
        #btn-1::after     { content: "1"; }
        #btn-2::after     { content: "2"; }
        #btn-select::after{ content: "SEL"; font-size: 16px; }
        #btn-start::after { content: "STA"; font-size: 16px; }
    </style>
</head>
<body>
    <div id="game-container"><div id="terminal">
        <div id="terminal-content">El juego no ha sido cargado aún</div>
    </div>
    
    <div id="controls">
        <!-- Tus controles aquí -->
        <div class="button-row">
            <div class="button-cell"><button class="btn" id="btn-1"></button></div>
            <div class="button-cell"><button class="btn" id="btn-up"></button></div>
            <div class="button-cell"><button class="btn" id="btn-2"></button></div>
        </div>
        <div class="button-row">
            <div class="button-cell"><button class="btn" id="btn-left"></button></div>
            <div class="button-cell"><button class="btn" id="btn-select"></button></div>
            <div class="button-cell"><button class="btn" id="btn-right"></button></div>
        </div>
        <div class="button-row">
            <div class="button-cell"><button class="btn" id="btn-a"></button></div>
            <div class="button-cell"><button class="btn" id="btn-down"></button></div>
            <div class="button-cell"><button class="btn" id="btn-b"></button></div>
        </div>
        <div class="button-row">
            <div class="button-cell"></div>
            <div class="button-cell"><button class="btn" id="btn-start"></button></div>
            <div class="button-cell"></div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    // ——— Terminal ———
    const termEl = document.getElementById('terminal-content');
    function printf(text) {
        termEl.textContent += text;
        termEl.scrollTop = termEl.scrollHeight;
    }
    function clearScreen() {
        termEl.textContent = '';
    }

    // ——— Formateo de lista ———
    function updateTextList(items, sel, cols) {
        let rows = Math.ceil(items.length / cols);
        let output = "";
        for (let row = 0; row < rows; row++) {
            let line = "";
            for (let col = 0; col < cols; col++) {
                let idx = row + col * rows;
                if (idx < items.length) {
                    let prefix = (sel === idx) ? "> " : "  ";
                    let text = items[idx];
                    while (text.length < 8) text += " ";
                    line += prefix + text;
                }
            }
            output += line.trimEnd() + "\n";
        }
        return output;
    }

    // ——— Variables de juego ———
    let hp = 10, level = 1, xp = 0, xpneed = 100, money = 0, mp = 0;
    let screen = 0, selected = 0;
    let inventory = [
        {name : "nothing", damage : 0, price : 0},
    ]
    let inv_ic = 1; //inventory Item Count
    const screenstats = 1;
    const screenmenu = 0;
    const screeninv = 2;
    const menutext = ["Inv","Explore","Stats","Rest"];

    // ——— Input ———
    let lastInput = null, previousKey = null;
    const keyMap = {
        'ArrowUp':    'U', 'ArrowDown':  'D',
        'ArrowLeft':  'L', 'ArrowRight': 'R',
        'Enter':      '+', ' ':          '-',
        'z':          'A', 'x':          'B',
        's':          '1', 'a':          '2'
    };
    // presionar
    document.addEventListener('keydown', e => {
        const m = keyMap[e.key];
        if (m && m !== previousKey) {
            lastInput = m; previousKey = m;
        }
    });
    // soltar
    document.addEventListener('keyup', e => {
        const m = keyMap[e.key];
        if (m && m === previousKey) previousKey = null;
    });
    // táctiles
    const btnMap = {
        'btn-up':'U','btn-down':'D','btn-left':'L','btn-right':'R',
        'btn-start':'+','btn-select':'-',
        'btn-a':'A','btn-b':'B','btn-1':'1','btn-2':'2'
    };
    Object.entries(btnMap).forEach(([id, code]) => {
        document.getElementById(id)?.addEventListener('click', () => {
            if (code !== previousKey) {
                lastInput = code;
                previousKey = code;
                // liberar previousKey tras 100 ms para simular keyup
                setTimeout(() => { previousKey = null; }, 100);
            }
        });
    });

    //lógica del juego

    // ——— Dibujar menú e info ———
    function draw_menu() {
        printf(updateTextList(menutext, selected, 2));
    }
    function draw_info() {
        printf("|Info|\n");
        printf(`[HP:${hp} MP:${mp}] [LV:${level} XP:${(xp/xpneed*100).toFixed(0)}%]\n[$:${money}]\n\n`);
    }

    function draw_inv() {
        printf("|Inventory|\n");
        for(let i = 0; i < inv_ic; i++)
        {
            printf("\n"+string(inventory[i].name));
        }

    }
    // ——— Inicio ———
    clearScreen();
    printf("FREAKIN' TEXT RPG 2!!! | Alfombracitarioj\n\n");
    printf("Long ago there were knights, witches, and demons, but today only demons remain. \nYou, the last light knight have to defeat all the monsters and demons.\n\nPress any key to start the game.");
    // ——— Lógica 16 ms ———
    setInterval(() => {
        if (lastInput) {
            switch (screen) {
                case screenmenu:
                    if (lastInput === 'R') selected = (selected - 2 + menutext.length) % menutext.length;
                    if (lastInput === 'L') selected = (selected + 2) % menutext.length;
                    if (lastInput === 'U' && selected % 2 === 1) selected--;
                    if (lastInput === 'D' && selected % 2 === 0 && selected + 1 < menutext.length) selected++;
                    if (lastInput === 'A' || lastInput === '2')
                    {
                        switch(selected)
                        {   
                            case 3:
                                screen = screenstats;
                            break;

                            case 1:
                                screen = screeninv;
                            break;
                        }
                    }
                    clearScreen();
                    printf("FREAKIN' TEXT RPG 2!!! | Alfombracitarioj\n\n");
                    draw_menu();
                    printf("\n");
                    draw_info();
                    break;
                case screenstats:
                    clearScreen();
                    draw_info();
                
                case screeninv:
                    clearScreen();
                    draw_inv();
                break;
                // otros screens...
            }
        }
        lastInput = null;
    }, 16);
});
</script>

</body>
</html>
